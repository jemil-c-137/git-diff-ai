#!/usr/bin/env node
var Ao=Object.create;var Ut=Object.defineProperty;var Co=Object.getOwnPropertyDescriptor;var vo=Object.getOwnPropertyNames;var Oo=Object.getPrototypeOf,Po=Object.prototype.hasOwnProperty;var C=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ro=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of vo(t))!Po.call(e,o)&&o!==r&&Ut(e,o,{get:()=>t[o],enumerable:!(n=Co(t,o))||n.enumerable});return e};var y=(e,t,r)=>(r=e!=null?Ao(Oo(e)):{},Ro(t||!e||!e.__esModule?Ut(r,"default",{value:e,enumerable:!0}):r,e));var Ve=C((pe,sr)=>{(function(e,t){typeof pe=="object"&&typeof sr<"u"?t(pe):typeof define=="function"&&define.amd?define(["exports"],t):t(e.WHATWGFetch={})})(pe,function(e){"use strict";var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function n(i){return i&&DataView.prototype.isPrototypeOf(i)}if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(i){return i&&o.indexOf(Object.prototype.toString.call(i))>-1};function a(i){if(typeof i!="string"&&(i=String(i)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(i)||i==="")throw new TypeError('Invalid character in header field name: "'+i+'"');return i.toLowerCase()}function l(i){return typeof i!="string"&&(i=String(i)),i}function f(i){var c={next:function(){var d=i.shift();return{done:d===void 0,value:d}}};return r.iterable&&(c[Symbol.iterator]=function(){return c}),c}function u(i){this.map={},i instanceof u?i.forEach(function(c,d){this.append(d,c)},this):Array.isArray(i)?i.forEach(function(c){if(c.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+c.length);this.append(c[0],c[1])},this):i&&Object.getOwnPropertyNames(i).forEach(function(c){this.append(c,i[c])},this)}u.prototype.append=function(i,c){i=a(i),c=l(c);var d=this.map[i];this.map[i]=d?d+", "+c:c},u.prototype.delete=function(i){delete this.map[a(i)]},u.prototype.get=function(i){return i=a(i),this.has(i)?this.map[i]:null},u.prototype.has=function(i){return this.map.hasOwnProperty(a(i))},u.prototype.set=function(i,c){this.map[a(i)]=l(c)},u.prototype.forEach=function(i,c){for(var d in this.map)this.map.hasOwnProperty(d)&&i.call(c,this.map[d],d,this)},u.prototype.keys=function(){var i=[];return this.forEach(function(c,d){i.push(d)}),f(i)},u.prototype.values=function(){var i=[];return this.forEach(function(c){i.push(c)}),f(i)},u.prototype.entries=function(){var i=[];return this.forEach(function(c,d){i.push([d,c])}),f(i)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function p(i){if(!i._noBody){if(i.bodyUsed)return Promise.reject(new TypeError("Already read"));i.bodyUsed=!0}}function x(i){return new Promise(function(c,d){i.onload=function(){c(i.result)},i.onerror=function(){d(i.error)}})}function S(i){var c=new FileReader,d=x(c);return c.readAsArrayBuffer(i),d}function A(i){var c=new FileReader,d=x(c),h=/charset=([A-Za-z0-9_-]+)/.exec(i.type),b=h?h[1]:"utf-8";return c.readAsText(i,b),d}function T(i){for(var c=new Uint8Array(i),d=new Array(c.length),h=0;h<c.length;h++)d[h]=String.fromCharCode(c[h]);return d.join("")}function I(i){if(i.slice)return i.slice(0);var c=new Uint8Array(i.byteLength);return c.set(new Uint8Array(i)),c.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(i){this.bodyUsed=this.bodyUsed,this._bodyInit=i,i?typeof i=="string"?this._bodyText=i:r.blob&&Blob.prototype.isPrototypeOf(i)?this._bodyBlob=i:r.formData&&FormData.prototype.isPrototypeOf(i)?this._bodyFormData=i:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(i)?this._bodyText=i.toString():r.arrayBuffer&&r.blob&&n(i)?(this._bodyArrayBuffer=I(i.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(i)||s(i))?this._bodyArrayBuffer=I(i):this._bodyText=i=Object.prototype.toString.call(i):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof i=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(i)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var i=p(this);if(i)return i;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var i=p(this);return i||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(r.blob)return this.blob().then(S);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var i=p(this);if(i)return i;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(ne)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(i){var c=i.toUpperCase();return L.indexOf(c)>-1?c:i}function O(i,c){if(!(this instanceof O))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');c=c||{};var d=c.body;if(i instanceof O){if(i.bodyUsed)throw new TypeError("Already read");this.url=i.url,this.credentials=i.credentials,c.headers||(this.headers=new u(i.headers)),this.method=i.method,this.mode=i.mode,this.signal=i.signal,!d&&i._bodyInit!=null&&(d=i._bodyInit,i.bodyUsed=!0)}else this.url=String(i);if(this.credentials=c.credentials||this.credentials||"same-origin",(c.headers||!this.headers)&&(this.headers=new u(c.headers)),this.method=D(c.method||this.method||"GET"),this.mode=c.mode||this.mode||null,this.signal=c.signal||this.signal||function(){if("AbortController"in t){var m=new AbortController;return m.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&d)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(d),(this.method==="GET"||this.method==="HEAD")&&(c.cache==="no-store"||c.cache==="no-cache")){var h=/([?&])_=[^&]*/;if(h.test(this.url))this.url=this.url.replace(h,"$1_="+new Date().getTime());else{var b=/\?/;this.url+=(b.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}O.prototype.clone=function(){return new O(this,{body:this._bodyInit})};function ne(i){var c=new FormData;return i.trim().split("&").forEach(function(d){if(d){var h=d.split("="),b=h.shift().replace(/\+/g," "),m=h.join("=").replace(/\+/g," ");c.append(decodeURIComponent(b),decodeURIComponent(m))}}),c}function oe(i){var c=new u,d=i.replace(/\r?\n[\t ]+/g," ");return d.split("\r").map(function(h){return h.indexOf(`
`)===0?h.substr(1,h.length):h}).forEach(function(h){var b=h.split(":"),m=b.shift().trim();if(m){var ie=b.join(":").trim();try{c.append(m,ie)}catch(De){console.warn("Response "+De.message)}}}),c}_.call(O.prototype);function v(i,c){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(c||(c={}),this.type="default",this.status=c.status===void 0?200:c.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=c.statusText===void 0?"":""+c.statusText,this.headers=new u(c.headers),this.url=c.url||"",this._initBody(i)}_.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},v.error=function(){var i=new v(null,{status:200,statusText:""});return i.ok=!1,i.status=0,i.type="error",i};var se=[301,302,303,307,308];v.redirect=function(i,c){if(se.indexOf(c)===-1)throw new RangeError("Invalid status code");return new v(null,{status:c,headers:{location:i}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(c,d){this.message=c,this.name=d;var h=Error(c);this.stack=h.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function Le(i,c){return new Promise(function(d,h){var b=new O(i,c);if(b.signal&&b.signal.aborted)return h(new e.DOMException("Aborted","AbortError"));var m=new XMLHttpRequest;function ie(){m.abort()}m.onload=function(){var E={statusText:m.statusText,headers:oe(m.getAllResponseHeaders()||"")};b.url.indexOf("file://")===0&&(m.status<200||m.status>599)?E.status=200:E.status=m.status,E.url="responseURL"in m?m.responseURL:E.headers.get("X-Request-URL");var j="response"in m?m.response:m.responseText;setTimeout(function(){d(new v(j,E))},0)},m.onerror=function(){setTimeout(function(){h(new TypeError("Network request failed"))},0)},m.ontimeout=function(){setTimeout(function(){h(new TypeError("Network request timed out"))},0)},m.onabort=function(){setTimeout(function(){h(new e.DOMException("Aborted","AbortError"))},0)};function De(E){try{return E===""&&t.location.href?t.location.href:E}catch{return E}}if(m.open(b.method,De(b.url),!0),b.credentials==="include"?m.withCredentials=!0:b.credentials==="omit"&&(m.withCredentials=!1),"responseType"in m&&(r.blob?m.responseType="blob":r.arrayBuffer&&(m.responseType="arraybuffer")),c&&typeof c.headers=="object"&&!(c.headers instanceof u||t.Headers&&c.headers instanceof t.Headers)){var Dt=[];Object.getOwnPropertyNames(c.headers).forEach(function(E){Dt.push(a(E)),m.setRequestHeader(E,l(c.headers[E]))}),b.headers.forEach(function(E,j){Dt.indexOf(j)===-1&&m.setRequestHeader(j,E)})}else b.headers.forEach(function(E,j){m.setRequestHeader(j,E)});b.signal&&(b.signal.addEventListener("abort",ie),m.onreadystatechange=function(){m.readyState===4&&b.signal.removeEventListener("abort",ie)}),m.send(typeof b._bodyInit>"u"?null:b._bodyInit)})}Le.polyfill=!0,t.fetch||(t.fetch=Le,t.Headers=u,t.Request=O,t.Response=v),e.Headers=u,e.Request=O,e.Response=v,e.fetch=Le,Object.defineProperty(e,"__esModule",{value:!0})})});var xr=C((Ea,wr)=>{wr.exports=br;br.sync=ss;var yr=require("fs");function os(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}function gr(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:os(t,r)}function br(e,t,r){yr.stat(e,function(n,o){r(n,n?!1:gr(o,e,t))})}function ss(e,t){return gr(yr.statSync(e),e,t)}});var Cr=C((Ta,Ar)=>{Ar.exports=Er;Er.sync=is;var Sr=require("fs");function Er(e,t,r){Sr.stat(e,function(n,o){r(n,n?!1:Tr(o,t))})}function is(e,t){return Tr(Sr.statSync(e),t)}function Tr(e,t){return e.isFile()&&as(e,t)}function as(e,t){var r=e.mode,n=e.uid,o=e.gid,s=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),a=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),l=parseInt("100",8),f=parseInt("010",8),u=parseInt("001",8),p=l|f,x=r&u||r&f&&o===a||r&l&&n===s||r&p&&s===0;return x}});var Or=C((Ca,vr)=>{var Aa=require("fs"),we;process.platform==="win32"||global.TESTING_WINDOWS?we=xr():we=Cr();vr.exports=ot;ot.sync=cs;function ot(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,o){ot(e,t||{},function(s,a){s?o(s):n(a)})})}we(e,t||{},function(n,o){n&&(n.code==="EACCES"||t&&t.ignoreErrors)&&(n=null,o=!1),r(n,o)})}function cs(e,t){try{return we.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var $r=C((va,_r)=>{var W=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Pr=require("path"),ls=W?";":":",Rr=Or(),Ir=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),Br=(e,t)=>{let r=t.colon||ls,n=e.match(/\//)||W&&e.match(/\\/)?[""]:[...W?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],o=W?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=W?o.split(r):[""];return W&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:n,pathExt:s,pathExtExe:o}},Nr=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:n,pathExt:o,pathExtExe:s}=Br(e,t),a=[],l=u=>new Promise((p,x)=>{if(u===n.length)return t.all&&a.length?p(a):x(Ir(e));let S=n[u],A=/^".*"$/.test(S)?S.slice(1,-1):S,T=Pr.join(A,e),I=!A&&/^\.[\\\/]/.test(e)?e.slice(0,2)+T:T;p(f(I,u,0))}),f=(u,p,x)=>new Promise((S,A)=>{if(x===o.length)return S(l(p+1));let T=o[x];Rr(u+T,{pathExt:s},(I,_)=>{if(!I&&_)if(t.all)a.push(u+T);else return S(u+T);return S(f(u,p,x+1))})});return r?l(0).then(u=>r(null,u),r):l(0)},us=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:n,pathExtExe:o}=Br(e,t),s=[];for(let a=0;a<r.length;a++){let l=r[a],f=/^".*"$/.test(l)?l.slice(1,-1):l,u=Pr.join(f,e),p=!f&&/^\.[\\\/]/.test(e)?e.slice(0,2)+u:u;for(let x=0;x<n.length;x++){let S=p+n[x];try{if(Rr.sync(S,{pathExt:o}))if(t.all)s.push(S);else return S}catch{}}}if(t.all&&s.length)return s;if(t.nothrow)return null;throw Ir(e)};_r.exports=Nr;Nr.sync=us});var jr=C((Oa,st)=>{"use strict";var Fr=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};st.exports=Fr;st.exports.default=Fr});var Lr=C((Pa,Gr)=>{"use strict";var kr=require("path"),fs=$r(),ds=jr();function Mr(e,t){let r=e.options.env||process.env,n=process.cwd(),o=e.options.cwd!=null,s=o&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(e.options.cwd)}catch{}let a;try{a=fs.sync(e.command,{path:r[ds({env:r})],pathExt:t?kr.delimiter:void 0})}catch{}finally{s&&process.chdir(n)}return a&&(a=kr.resolve(o?e.options.cwd:"",a)),a}function ps(e){return Mr(e)||Mr(e,!0)}Gr.exports=ps});var Dr=C((Ra,at)=>{"use strict";var it=/([()\][%!^"`<>&|;, *?])/g;function ms(e){return e=e.replace(it,"^$1"),e}function hs(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(it,"^$1"),t&&(e=e.replace(it,"^$1")),e}at.exports.command=ms;at.exports.argument=hs});var zr=C((Ia,Ur)=>{"use strict";Ur.exports=/^#!(.*)/});var Wr=C((Ba,Hr)=>{"use strict";var ys=zr();Hr.exports=(e="")=>{let t=e.match(ys);if(!t)return null;let[r,n]=t[0].replace(/#! ?/,"").split(" "),o=r.split("/").pop();return o==="env"?n:n?`${o} ${n}`:o}});var Vr=C((Na,qr)=>{"use strict";var ct=require("fs"),gs=Wr();function bs(e){let r=Buffer.alloc(150),n;try{n=ct.openSync(e,"r"),ct.readSync(n,r,0,150,0),ct.closeSync(n)}catch{}return gs(r.toString())}qr.exports=bs});var Jr=C((_a,Xr)=>{"use strict";var ws=require("path"),Yr=Lr(),Kr=Dr(),xs=Vr(),Ss=process.platform==="win32",Es=/\.(?:com|exe)$/i,Ts=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function As(e){e.file=Yr(e);let t=e.file&&xs(e.file);return t?(e.args.unshift(e.file),e.command=t,Yr(e)):e.file}function Cs(e){if(!Ss)return e;let t=As(e),r=!Es.test(t);if(e.options.forceShell||r){let n=Ts.test(t);e.command=ws.normalize(e.command),e.command=Kr.command(e.command),e.args=e.args.map(s=>Kr.argument(s,n));let o=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${o}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function vs(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let n={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?n:Cs(n)}Xr.exports=vs});var en=C(($a,Qr)=>{"use strict";var lt=process.platform==="win32";function ut(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function Os(e,t){if(!lt)return;let r=e.emit;e.emit=function(n,o){if(n==="exit"){let s=Zr(o,t,"spawn");if(s)return r.call(e,"error",s)}return r.apply(e,arguments)}}function Zr(e,t){return lt&&e===1&&!t.file?ut(t.original,"spawn"):null}function Ps(e,t){return lt&&e===1&&!t.file?ut(t.original,"spawnSync"):null}Qr.exports={hookChildProcess:Os,verifyENOENT:Zr,verifyENOENTSync:Ps,notFoundError:ut}});var nn=C((Fa,q)=>{"use strict";var tn=require("child_process"),ft=Jr(),dt=en();function rn(e,t,r){let n=ft(e,t,r),o=tn.spawn(n.command,n.args,n.options);return dt.hookChildProcess(o,n),o}function Rs(e,t,r){let n=ft(e,t,r),o=tn.spawnSync(n.command,n.args,n.options);return o.error=o.error||dt.verifyENOENTSync(o.status,n),o}q.exports=rn;q.exports.spawn=rn;q.exports.sync=Rs;q.exports._parse=ft;q.exports._enoent=dt});var kn=C((Ic,jn)=>{"use strict";var{PassThrough:Si}=require("stream");jn.exports=function(){var e=[],t=new Si({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=n,t.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(r),t;function r(s){return Array.isArray(s)?(s.forEach(r),this):(e.push(s),s.once("end",o.bind(null,s)),s.once("error",t.emit.bind(t,"error")),s.pipe(t,{end:!1}),this)}function n(){return e.length==0}function o(s){e=e.filter(function(a){return a!==s}),!e.length&&t.readable&&t.end()}}});var or=require("child_process");var er=y(require("path"),1);var zt=(e=0)=>t=>`\x1B[${t+e}m`,Ht=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,Wt=(e=0)=>(t,r,n)=>`\x1B[${38+e};2;${t};${r};${n}m`,g={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},Vi=Object.keys(g.modifier),Io=Object.keys(g.color),Bo=Object.keys(g.bgColor),Yi=[...Io,...Bo];function No(){let e=new Map;for(let[t,r]of Object.entries(g)){for(let[n,o]of Object.entries(r))g[n]={open:`\x1B[${o[0]}m`,close:`\x1B[${o[1]}m`},r[n]=g[n],e.set(o[0],o[1]);Object.defineProperty(g,t,{value:r,enumerable:!1})}return Object.defineProperty(g,"codes",{value:e,enumerable:!1}),g.color.close="\x1B[39m",g.bgColor.close="\x1B[49m",g.color.ansi=zt(),g.color.ansi256=Ht(),g.color.ansi16m=Wt(),g.bgColor.ansi=zt(10),g.bgColor.ansi256=Ht(10),g.bgColor.ansi16m=Wt(10),Object.defineProperties(g,{rgbToAnsi256:{value(t,r,n){return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},enumerable:!1},hexToRgb:{value(t){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[n]=r;n.length===3&&(n=[...n].map(s=>s+s).join(""));let o=Number.parseInt(n,16);return[o>>16&255,o>>8&255,o&255]},enumerable:!1},hexToAnsi256:{value:t=>g.rgbToAnsi256(...g.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,n,o;if(t>=232)r=((t-232)*10+8)/255,n=r,o=r;else{t-=16;let l=t%36;r=Math.floor(t/36)/5,n=Math.floor(l/6)/5,o=l%6/5}let s=Math.max(r,n,o)*2;if(s===0)return 30;let a=30+(Math.round(o)<<2|Math.round(n)<<1|Math.round(r));return s===2&&(a+=60),a},enumerable:!1},rgbToAnsi:{value:(t,r,n)=>g.ansi256ToAnsi(g.rgbToAnsi256(t,r,n)),enumerable:!1},hexToAnsi:{value:t=>g.ansi256ToAnsi(g.hexToAnsi256(t)),enumerable:!1}}),g}var _o=No(),N=_o;var ce=y(require("node:process"),1),Vt=y(require("node:os"),1),Ue=y(require("node:tty"),1);function B(e,t=globalThis.Deno?globalThis.Deno.args:ce.default.argv){let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),o=t.indexOf("--");return n!==-1&&(o===-1||n<o)}var{env:w}=ce.default,ae;B("no-color")||B("no-colors")||B("color=false")||B("color=never")?ae=0:(B("color")||B("colors")||B("color=true")||B("color=always"))&&(ae=1);function $o(){if("FORCE_COLOR"in w)return w.FORCE_COLOR==="true"?1:w.FORCE_COLOR==="false"?0:w.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(w.FORCE_COLOR,10),3)}function Fo(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function jo(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let n=$o();n!==void 0&&(ae=n);let o=r?ae:n;if(o===0)return 0;if(r){if(B("color=16m")||B("color=full")||B("color=truecolor"))return 3;if(B("color=256"))return 2}if("TF_BUILD"in w&&"AGENT_NAME"in w)return 1;if(e&&!t&&o===void 0)return 0;let s=o||0;if(w.TERM==="dumb")return s;if(ce.default.platform==="win32"){let a=Vt.default.release().split(".");return Number(a[0])>=10&&Number(a[2])>=10586?Number(a[2])>=14931?3:2:1}if("CI"in w)return"GITHUB_ACTIONS"in w||"GITEA_ACTIONS"in w?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(a=>a in w)||w.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in w)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(w.TEAMCITY_VERSION)?1:0;if(w.COLORTERM==="truecolor"||w.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in w){let a=Number.parseInt((w.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(w.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(w.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(w.TERM)||"COLORTERM"in w?1:s}function qt(e,t={}){let r=jo(e,{streamIsTTY:e&&e.isTTY,...t});return Fo(r)}var ko={stdout:qt({isTTY:Ue.default.isatty(1)}),stderr:qt({isTTY:Ue.default.isatty(2)})},Yt=ko;function Kt(e,t,r){let n=e.indexOf(t);if(n===-1)return e;let o=t.length,s=0,a="";do a+=e.slice(s,n)+t+r,s=n+o,n=e.indexOf(t,s);while(n!==-1);return a+=e.slice(s),a}function Xt(e,t,r,n){let o=0,s="";do{let a=e[n-1]==="\r";s+=e.slice(o,a?n-1:n)+t+(a?`\r
`:`
`)+r,o=n+1,n=e.indexOf(`
`,o)}while(n!==-1);return s+=e.slice(o),s}var{stdout:Jt,stderr:Zt}=Yt,ze=Symbol("GENERATOR"),U=Symbol("STYLER"),Y=Symbol("IS_EMPTY"),Qt=["ansi","ansi","ansi256","ansi16m"],z=Object.create(null),Mo=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=Jt?Jt.level:0;e.level=t.level===void 0?r:t.level};var Go=e=>{let t=(...r)=>r.join(" ");return Mo(t,e),Object.setPrototypeOf(t,K.prototype),t};function K(e){return Go(e)}Object.setPrototypeOf(K.prototype,Function.prototype);for(let[e,t]of Object.entries(N))z[e]={get(){let r=le(this,We(t.open,t.close,this[U]),this[Y]);return Object.defineProperty(this,e,{value:r}),r}};z.visible={get(){let e=le(this,this[U],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var He=(e,t,r,...n)=>e==="rgb"?t==="ansi16m"?N[r].ansi16m(...n):t==="ansi256"?N[r].ansi256(N.rgbToAnsi256(...n)):N[r].ansi(N.rgbToAnsi(...n)):e==="hex"?He("rgb",t,r,...N.hexToRgb(...n)):N[r][e](...n),Lo=["rgb","hex","ansi256"];for(let e of Lo){z[e]={get(){let{level:r}=this;return function(...n){let o=We(He(e,Qt[r],"color",...n),N.color.close,this[U]);return le(this,o,this[Y])}}};let t="bg"+e[0].toUpperCase()+e.slice(1);z[t]={get(){let{level:r}=this;return function(...n){let o=We(He(e,Qt[r],"bgColor",...n),N.bgColor.close,this[U]);return le(this,o,this[Y])}}}}var Do=Object.defineProperties(()=>{},{...z,level:{enumerable:!0,get(){return this[ze].level},set(e){this[ze].level=e}}}),We=(e,t,r)=>{let n,o;return r===void 0?(n=e,o=t):(n=r.openAll+e,o=t+r.closeAll),{open:e,close:t,openAll:n,closeAll:o,parent:r}},le=(e,t,r)=>{let n=(...o)=>Uo(n,o.length===1?""+o[0]:o.join(" "));return Object.setPrototypeOf(n,Do),n[ze]=e,n[U]=t,n[Y]=r,n},Uo=(e,t)=>{if(e.level<=0||!t)return e[Y]?"":t;let r=e[U];if(r===void 0)return t;let{openAll:n,closeAll:o}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=Kt(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=Xt(t,o,n,s)),n+t+o};Object.defineProperties(K.prototype,z);var zo=K(),ta=K({level:Zt?Zt.level:0});var H=zo;var Ho=[".png",".jpg",".jpeg",".gif",".bmp",".webp",".mp3",".wav",".ogg",".flac",".aac",".mp4",".avi",".mkv",".mov",".wmv",".xml",".csv",".yml",".yaml",".po",".pot",".mo",".tar",".zip",".rar",".7z",".gz",".pdf",".doc",".docx",".xls",".xlsx",".dmg",".iso",".img",".sqlite",".db",".log",".tmp",".key",".p12",".pem",".bat",".sh"];function tr(e){let t=er.default.extname(e).toLowerCase();return Ho.includes(t)}function Wo(){let e=process.version,t=18;if(parseInt(e.slice(1).split(".")[0],10)<t)throw new Error(`Node.js version ${t} or higher is required. Current version: ${e}`)}function rr(e){Wo();let t={modelName:"qwen2.5:7b",maxDiffSize:1e4,maxFiles:50};for(let r=0;r<e.length;r++)switch(e[r]){case"--model":t.modelName=e[++r];break;case"--max-diff-size":t.maxDiffSize=parseInt(e[++r],10);break;case"--max-files":t.maxFiles=parseInt(e[++r],10);break}return t}function qe(e){return H.cyan(e)}function ue(e){return H.yellow.bold(e)}function k(e){return H.green(e)}function nr(e){return H.red(e)}function fe(e){return H.yellow(e)}var de=class{constructor(t=1e4,r=50){this.maxDiffSize=t,this.maxFiles=r}async generateDiffs(){try{let t=(0,or.execSync)("git diff --cached",{encoding:"utf-8"});return this.streamDiffs(t)}catch(t){throw new Error(`Failed to generate git diff: ${t.message}`)}}streamDiffs(t){return t.split("diff --git").slice(1).map(n=>`diff --git${n}`).filter((n,o)=>{let s=n.split(`
`)[0].split(" ")[2];return o>=this.maxFiles?(console.warn(`Skipping file beyond the limit of ${this.maxFiles}: ${s}`),!1):tr(s)?(console.log(`Skipping excluded file: ${s}`),!1):n.length>this.maxDiffSize?(console.log(`Skipping large diff for file: ${s}`),!1):!0})}};var aa=y(Ve(),1),qo="0.5.9",Vo=Object.defineProperty,Yo=(e,t,r)=>t in e?Vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ye=(e,t,r)=>(Yo(e,typeof t!="symbol"?t+"":t,r),r),X=class extends Error{constructor(t,r){super(t),this.error=t,this.status_code=r,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,X)}},Xe=class{constructor(t,r,n){Ye(this,"abortController"),Ye(this,"itr"),Ye(this,"doneCallback"),this.abortController=t,this.itr=r,this.doneCallback=n}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(let t of this.itr){if("error"in t)throw new Error(t.error);if(yield t,t.done||t.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}},me=async e=>{if(e.ok)return;let t=`Error ${e.status}: ${e.statusText}`,r=null;if(e.headers.get("content-type")?.includes("application/json"))try{r=await e.json(),t=r.error||t}catch{console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),t=await e.text()||t}catch{console.log("Failed to get text from error response")}throw new X(t,e.status)};function Ko(){return typeof window<"u"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process<"u"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}var he=async(e,t,r={})=>{let n={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${qo} (${Ko()})`};return r.headers||(r.headers={}),r.headers={...n,...r.headers},e(t,r)},ir=async(e,t)=>{let r=await he(e,t);return await me(r),r},ar=async(e,t)=>{let r=await he(e,t,{method:"HEAD"});return await me(r),r},$=async(e,t,r,n)=>{let s=(l=>l!==null&&typeof l=="object"&&!Array.isArray(l))(r)?JSON.stringify(r):r,a=await he(e,t,{method:"POST",body:s,signal:n?.signal,headers:n?.headers});return await me(a),a},Xo=async(e,t,r)=>{let n=await he(e,t,{method:"DELETE",body:JSON.stringify(r)});return await me(n),n},Jo=async function*(e){let t=new TextDecoder("utf-8"),r="",n=e.getReader();for(;;){let{done:o,value:s}=await n.read();if(o)break;r+=t.decode(s);let a=r.split(`
`);r=a.pop()??"";for(let l of a)try{yield JSON.parse(l)}catch{console.warn("invalid json: ",l)}}for(let o of r.split(`
`).filter(s=>s!==""))try{yield JSON.parse(o)}catch{console.warn("invalid json: ",o)}},Zo=e=>{if(!e)return"http://127.0.0.1:11434";let t=e.includes("://");e.startsWith(":")&&(e=`http://127.0.0.1${e}`,t=!0),t||(e=`http://${e}`);let r=new URL(e),n=r.port;n||(t?n=r.protocol==="https:"?"443":"80":n="11434");let o=`${r.protocol}//${r.hostname}:${n}${r.pathname}`;return o.endsWith("/")&&(o=o.slice(0,-1)),o},Qo=Object.defineProperty,es=(e,t,r)=>t in e?Qo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ke=(e,t,r)=>(es(e,typeof t!="symbol"?t+"":t,r),r),Je=class{constructor(t){Ke(this,"config"),Ke(this,"fetch"),Ke(this,"ongoingStreamedRequests",[]),this.config={host:""},t?.proxy||(this.config.host=Zo(t?.host??"http://127.0.0.1:11434")),this.fetch=fetch,t?.fetch!=null&&(this.fetch=t.fetch)}abort(){for(let t of this.ongoingStreamedRequests)t.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(t,r){r.stream=r.stream??!1;let n=`${this.config.host}/api/${t}`;if(r.stream){let s=new AbortController,a=await $(this.fetch,n,r,{signal:s.signal,headers:this.config.headers});if(!a.body)throw new Error("Missing body");let l=Jo(a.body),f=new Xe(s,l,()=>{let u=this.ongoingStreamedRequests.indexOf(f);u>-1&&this.ongoingStreamedRequests.splice(u,1)});return this.ongoingStreamedRequests.push(f),f}return await(await $(this.fetch,n,r,{headers:this.config.headers})).json()}async encodeImage(t){if(typeof t!="string"){let r=new Uint8Array(t),n="",o=r.byteLength;for(let s=0;s<o;s++)n+=String.fromCharCode(r[s]);return btoa(n)}return t}async generate(t){return t.images&&(t.images=await Promise.all(t.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",t)}async chat(t){if(t.messages)for(let r of t.messages)r.images&&(r.images=await Promise.all(r.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",t)}async create(t){return this.processStreamableRequest("create",{name:t.model,stream:t.stream,modelfile:t.modelfile,quantize:t.quantize})}async pull(t){return this.processStreamableRequest("pull",{name:t.model,stream:t.stream,insecure:t.insecure})}async push(t){return this.processStreamableRequest("push",{name:t.model,stream:t.stream,insecure:t.insecure})}async delete(t){return await Xo(this.fetch,`${this.config.host}/api/delete`,{name:t.model}),{status:"success"}}async copy(t){return await $(this.fetch,`${this.config.host}/api/copy`,{...t}),{status:"success"}}async list(){return await(await ir(this.fetch,`${this.config.host}/api/tags`)).json()}async show(t){return await(await $(this.fetch,`${this.config.host}/api/show`,{...t})).json()}async embed(t){return await(await $(this.fetch,`${this.config.host}/api/embed`,{...t})).json()}async embeddings(t){return await(await $(this.fetch,`${this.config.host}/api/embeddings`,{...t})).json()}async ps(){return await(await ir(this.fetch,`${this.config.host}/api/ps`)).json()}},la=new Je;var F=y(require("fs"),1),M=require("path"),cr=require("crypto"),lr=require("os"),da=y(Ve(),1),Ze=class extends Je{async encodeImage(t){if(typeof t!="string")return Buffer.from(t).toString("base64");try{if(F.default.existsSync(t)){let r=await F.promises.readFile((0,M.resolve)(t));return Buffer.from(r).toString("base64")}}catch{}return t}async parseModelfile(t,r=process.cwd()){let n=[],o=t.split(`
`);for(let s of o){let[a,l]=s.split(" ",2);if(["FROM","ADAPTER"].includes(a.toUpperCase())){let f=this.resolvePath(l.trim(),r);await this.fileExists(f)?n.push(`${a} @${await this.createBlob(f)}`):n.push(`${a} ${l}`)}else n.push(s)}return n.join(`
`)}resolvePath(t,r){return t.startsWith("~")?(0,M.join)((0,lr.homedir)(),t.slice(1)):(0,M.resolve)(r,t)}async fileExists(t){try{return await F.promises.access(t),!0}catch{return!1}}async createBlob(t){if(typeof ReadableStream>"u")throw new Error("Streaming uploads are not supported in this environment.");let r=(0,F.createReadStream)(t),o=`sha256:${await new Promise((s,a)=>{let l=(0,cr.createHash)("sha256");r.on("data",f=>l.update(f)),r.on("end",()=>s(l.digest("hex"))),r.on("error",a)})}`;try{await ar(this.fetch,`${this.config.host}/api/blobs/${o}`)}catch(s){if(s instanceof Error&&s.message.includes("404")){let a=new ReadableStream({start(l){r.on("data",f=>{l.enqueue(f)}),r.on("end",()=>{l.close()}),r.on("error",f=>{l.error(f)})}});await $(this.fetch,`${this.config.host}/api/blobs/${o}`,a)}else throw s}return o}async create(t){let r="";if(t.path)r=await F.promises.readFile(t.path,{encoding:"utf8"}),r=await this.parseModelfile(r,(0,M.dirname)(t.path));else if(t.modelfile)r=await this.parseModelfile(t.modelfile);else throw new Error("Must provide either path or modelfile to create a model");return t.modelfile=r,t.stream?super.create(t):super.create(t)}},ur=new Ze;var ye=class{constructor(t){this.modelName=t}async generateResponse(t,r=3){let n=0;for(;n<r;)try{return(await ur.chat({model:this.modelName,messages:[{role:"user",content:t}],stream:!1})).message.content.trim()}catch(o){if(n++,console.warn(`Attempt ${n} failed: ${o.message}`),n>=r)throw new Error(`Failed to communicate with the model after ${r} attempts`);await new Promise(s=>setTimeout(s,1e3*n))}}};var ge=class{constructor(t){this.modelCommunicator=t,this.previousMessages=[]}async generateMessages(t){let r=[];for(let n of t){let o=await this.generateCommitMessage(n);o&&(r.push(o),this.previousMessages.push(o))}return r}async generateCommitMessage(t){let r=this.createCommitPrompt(t);return await this.modelCommunicator.generateResponse(r)}async generateSummaryMessage(t){let r=this.createSummaryPrompt(t);return await this.modelCommunicator.generateResponse(r)}createCommitPrompt(t){return`
Generate a Git commit message for the following diff:

${t}

Previous commit messages:
${this.previousMessages.join(`
`)}

Instructions:
1. Summarize the purpose of the changes in under 100 characters.
2. If needed, use bullet points to briefly list key changes.
3. Focus only on the changes in the code diff.
4. If the diff doesn't reflect significant changes, return an empty string.
5. Do not include explanations or analysis in the commit message.

Commit Message:`}createSummaryPrompt(t){return`
Based on the following commit messages for individual files, generate a concise summary commit message:

${t.join(`
`)}

Instructions:
1. Summarize the overall changes in under 100 characters.
2. If needed, use bullet points to highlight key changes across files.
3. Focus on the most important changes.

Summary Commit Message:`}};var Lt=y(require("node:process"),1);var nt=y(require("node:process"),1),pr=y(require("node:os"),1),mr=y(require("node:fs"),1);var fr=y(require("node:fs"),1);var et=y(require("node:fs"),1),Qe;function ts(){try{return et.default.statSync("/.dockerenv"),!0}catch{return!1}}function rs(){try{return et.default.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}function tt(){return Qe===void 0&&(Qe=ts()||rs()),Qe}var rt,ns=()=>{try{return fr.default.statSync("/run/.containerenv"),!0}catch{return!1}};function be(){return rt===void 0&&(rt=ns()||tt()),rt}var dr=()=>{if(nt.default.platform!=="linux")return!1;if(pr.default.release().toLowerCase().includes("microsoft"))return!be();try{return mr.default.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!be():!1}catch{return!1}},hr=nt.default.env.__IS_WSL_TEST__?dr:dr();var to=require("node:buffer"),ro=y(require("node:path"),1),_e=y(require("node:child_process"),1),ee=y(require("node:process"),1),no=y(nn(),1);function pt(e){let t=typeof e=="string"?`
`:`
`.charCodeAt(),r=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}var J=y(require("node:process"),1),V=y(require("node:path"),1),mt=require("node:url");function xe(e={}){let{env:t=process.env,platform:r=process.platform}=e;return r!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}var Is=({cwd:e=J.default.cwd(),path:t=J.default.env[xe()],preferLocal:r=!0,execPath:n=J.default.execPath,addExecPath:o=!0}={})=>{let s=e instanceof URL?(0,mt.fileURLToPath)(e):e,a=V.default.resolve(s),l=[];return r&&Bs(l,a),o&&Ns(l,n,a),[...l,t].join(V.default.delimiter)},Bs=(e,t)=>{let r;for(;r!==t;)e.push(V.default.join(t,"node_modules/.bin")),r=t,t=V.default.resolve(t,"..")},Ns=(e,t,r)=>{let n=t instanceof URL?(0,mt.fileURLToPath)(t):t;e.push(V.default.resolve(r,n,".."))},on=({env:e=J.default.env,...t}={})=>{e={...e};let r=xe({env:e});return t.path=e[r],e[r]=Is(t),e};var _s=(e,t,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let o=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!$s(o,s)&&n||Object.defineProperty(e,r,s)},$s=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},Fs=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},js=(e,t)=>`/* Wrapped ${e}*/
${t}`,ks=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Ms=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Gs=(e,t,r)=>{let n=r===""?"":`with ${r.trim()}() `,o=js.bind(null,n,t.toString());Object.defineProperty(o,"name",Ms),Object.defineProperty(e,"toString",{...ks,value:o})};function ht(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:n}=e;for(let o of Reflect.ownKeys(t))_s(e,t,o,r);return Fs(e,t),Gs(e,t,n),e}var Se=new WeakMap,sn=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,n=0,o=e.displayName||e.name||"<anonymous>",s=function(...a){if(Se.set(s,++n),n===1)r=e.apply(this,a),e=null;else if(t.throw===!0)throw new Error(`Function \`${o}\` can only be called once`);return r};return ht(s,e),Se.set(s,n),s};sn.callCount=e=>{if(!Se.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return Se.get(e)};var an=sn;var hn=y(require("node:process"),1);var pn=require("node:os");var cn=()=>{let e=un-ln+1;return Array.from({length:e},Ls)},Ls=(e,t)=>({name:`SIGRT${t+1}`,number:ln+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}),ln=34,un=64;var dn=require("node:os");var fn=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var yt=()=>{let e=cn();return[...fn,...e].map(Ds)},Ds=({name:e,number:t,description:r,action:n,forced:o=!1,standard:s})=>{let{signals:{[e]:a}}=dn.constants,l=a!==void 0;return{name:e,number:l?a:t,description:r,supported:l,action:n,forced:o,standard:s}};var Us=()=>{let e=yt();return Object.fromEntries(e.map(zs))},zs=({name:e,number:t,description:r,supported:n,action:o,forced:s,standard:a})=>[e,{name:e,number:t,description:r,supported:n,action:o,forced:s,standard:a}],mn=Us(),Hs=()=>{let e=yt(),t=64+1,r=Array.from({length:t},(n,o)=>Ws(o,e));return Object.assign({},...r)},Ws=(e,t)=>{let r=qs(e,t);if(r===void 0)return{};let{name:n,description:o,supported:s,action:a,forced:l,standard:f}=r;return{[e]:{name:n,number:e,description:o,supported:s,action:a,forced:l,standard:f}}},qs=(e,t)=>{let r=t.find(({name:n})=>pn.constants.signals[n]===e);return r!==void 0?r:t.find(n=>n.number===e)},Ka=Hs();var Vs=({timedOut:e,timeout:t,errorCode:r,signal:n,signalDescription:o,exitCode:s,isCanceled:a})=>e?`timed out after ${t} milliseconds`:a?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${o})`:s!==void 0?`failed with exit code ${s}`:"failed",Z=({stdout:e,stderr:t,all:r,error:n,signal:o,exitCode:s,command:a,escapedCommand:l,timedOut:f,isCanceled:u,killed:p,parsed:{options:{timeout:x,cwd:S=hn.default.cwd()}}})=>{s=s===null?void 0:s,o=o===null?void 0:o;let A=o===void 0?void 0:mn[o].description,T=n&&n.code,_=`Command ${Vs({timedOut:f,timeout:x,errorCode:T,signal:o,signalDescription:A,exitCode:s,isCanceled:u})}: ${a}`,L=Object.prototype.toString.call(n)==="[object Error]",D=L?`${_}
${n.message}`:_,O=[D,t,e].filter(Boolean).join(`
`);return L?(n.originalMessage=n.message,n.message=O):n=new Error(O),n.shortMessage=D,n.command=a,n.escapedCommand=l,n.exitCode=s,n.signal=o,n.signalDescription=A,n.stdout=e,n.stderr=t,n.cwd=S,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!f,n.isCanceled=u,n.killed=p&&!f,n};var Ee=["stdin","stdout","stderr"],Ys=e=>Ee.some(t=>e[t]!==void 0),yn=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return Ee.map(n=>e[n]);if(Ys(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Ee.map(n=>`\`${n}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,Ee.length);return Array.from({length:r},(n,o)=>t[o])};var bn=y(require("node:os"),1);var G=[];G.push("SIGHUP","SIGINT","SIGTERM");process.platform!=="win32"&&G.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&G.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT");var Te=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",gt=Symbol.for("signal-exit emitter"),bt=globalThis,Ks=Object.defineProperty.bind(Object),wt=class{emitted={afterExit:!1,exit:!1};listeners={afterExit:[],exit:[]};count=0;id=Math.random();constructor(){if(bt[gt])return bt[gt];Ks(bt,gt,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,r){this.listeners[t].push(r)}removeListener(t,r){let n=this.listeners[t],o=n.indexOf(r);o!==-1&&(o===0&&n.length===1?n.length=0:n.splice(o,1))}emit(t,r,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let o=!1;for(let s of this.listeners[t])o=s(r,n)===!0||o;return t==="exit"&&(o=this.emit("afterExit",r,n)||o),o}},Ae=class{},Xs=e=>({onExit(t,r){return e.onExit(t,r)},load(){return e.load()},unload(){return e.unload()}}),xt=class extends Ae{onExit(){return()=>{}}load(){}unload(){}},St=class extends Ae{#i=Et.platform==="win32"?"SIGINT":"SIGHUP";#t=new wt;#e;#o;#s;#n={};#r=!1;constructor(t){super(),this.#e=t,this.#n={};for(let r of G)this.#n[r]=()=>{let n=this.#e.listeners(r),{count:o}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(o+=s.__signal_exit_emitter__.count),n.length===o){this.unload();let a=this.#t.emit("exit",null,r),l=r==="SIGHUP"?this.#i:r;a||t.kill(t.pid,l)}};this.#s=t.reallyExit,this.#o=t.emit}onExit(t,r){if(!Te(this.#e))return()=>{};this.#r===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#r){this.#r=!0,this.#t.count+=1;for(let t of G)try{let r=this.#n[t];r&&this.#e.on(t,r)}catch{}this.#e.emit=(t,...r)=>this.#c(t,...r),this.#e.reallyExit=t=>this.#a(t)}}unload(){this.#r&&(this.#r=!1,G.forEach(t=>{let r=this.#n[t];if(!r)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,r)}catch{}}),this.#e.emit=this.#o,this.#e.reallyExit=this.#s,this.#t.count-=1)}#a(t){return Te(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#s.call(this.#e,this.#e.exitCode)):0}#c(t,...r){let n=this.#o;if(t==="exit"&&Te(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let o=n.call(this.#e,t,...r);return this.#t.emit("exit",this.#e.exitCode,null),o}else return n.call(this.#e,t,...r)}},Et=globalThis.process,{onExit:gn,load:rc,unload:nc}=Xs(Te(Et)?new St(Et):new xt);var Js=1e3*5,wn=(e,t="SIGTERM",r={})=>{let n=e(t);return Zs(e,t,r,n),n},Zs=(e,t,r,n)=>{if(!Qs(t,r,n))return;let o=ti(r),s=setTimeout(()=>{e("SIGKILL")},o);s.unref&&s.unref()},Qs=(e,{forceKillAfterTimeout:t},r)=>ei(e)&&t!==!1&&r,ei=e=>e===bn.default.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",ti=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return Js;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},xn=(e,t)=>{e.kill()&&(t.isCanceled=!0)},ri=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},Sn=(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(t===0||t===void 0)return n;let o,s=new Promise((l,f)=>{o=setTimeout(()=>{ri(e,r,f)},t)}),a=n.finally(()=>{clearTimeout(o)});return Promise.race([s,a])},En=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},Tn=async(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;let o=gn(()=>{e.kill()});return n.finally(()=>{o()})};var An=require("node:fs"),Cn=require("node:child_process");function Ce(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function Tt(e){return Ce(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}var ni=e=>e instanceof Cn.ChildProcess&&typeof e.then=="function",At=(e,t,r)=>{if(typeof r=="string")return e[t].pipe((0,An.createWriteStream)(r)),e;if(Tt(r))return e[t].pipe(r),e;if(!ni(r))throw new TypeError("The second argument must be a string, a stream or an Execa child process.");if(!Tt(r.stdin))throw new TypeError("The target child process's stdin must be available.");return e[t].pipe(r.stdin),r},vn=e=>{e.stdout!==null&&(e.pipeStdout=At.bind(void 0,e,"stdout")),e.stderr!==null&&(e.pipeStderr=At.bind(void 0,e,"stderr")),e.all!==void 0&&(e.pipeAll=At.bind(void 0,e,"all"))};var Be=require("node:fs"),Mn=require("node:timers/promises");var Q=async(e,{init:t,convertChunk:r,getSize:n,truncateChunk:o,addChunk:s,getFinalChunk:a,finalize:l},{maxBuffer:f=Number.POSITIVE_INFINITY}={})=>{if(!si(e))throw new Error("The first argument must be a Readable, a ReadableStream, or an async iterable.");let u=t();u.length=0;try{for await(let p of e){let x=ii(p),S=r[x](p,u);Rn({convertedChunk:S,state:u,getSize:n,truncateChunk:o,addChunk:s,maxBuffer:f})}return oi({state:u,convertChunk:r,getSize:n,truncateChunk:o,addChunk:s,getFinalChunk:a,maxBuffer:f}),l(u)}catch(p){throw p.bufferedData=l(u),p}},oi=({state:e,getSize:t,truncateChunk:r,addChunk:n,getFinalChunk:o,maxBuffer:s})=>{let a=o(e);a!==void 0&&Rn({convertedChunk:a,state:e,getSize:t,truncateChunk:r,addChunk:n,maxBuffer:s})},Rn=({convertedChunk:e,state:t,getSize:r,truncateChunk:n,addChunk:o,maxBuffer:s})=>{let a=r(e),l=t.length+a;if(l<=s){On(e,t,o,l);return}let f=n(e,s-t.length);throw f!==void 0&&On(f,t,o,s),new ve},On=(e,t,r,n)=>{t.contents=r(e,t,n),t.length=n},si=e=>typeof e=="object"&&e!==null&&typeof e[Symbol.asyncIterator]=="function",ii=e=>{let t=typeof e;if(t==="string")return"string";if(t!=="object"||e===null)return"others";if(globalThis.Buffer?.isBuffer(e))return"buffer";let r=Pn.call(e);return r==="[object ArrayBuffer]"?"arrayBuffer":r==="[object DataView]"?"dataView":Number.isInteger(e.byteLength)&&Number.isInteger(e.byteOffset)&&Pn.call(e.buffer)==="[object ArrayBuffer]"?"typedArray":"others"},{toString:Pn}=Object.prototype,ve=class extends Error{name="MaxBufferError";constructor(){super("maxBuffer exceeded")}};var Ct=e=>e,vt=()=>{},Ot=({contents:e})=>e,Oe=e=>{throw new Error(`Streams in object mode are not supported: ${String(e)}`)},Pe=e=>e.length;async function Pt(e,t){return Q(e,hi,t)}var ai=()=>({contents:new ArrayBuffer(0)}),ci=e=>li.encode(e),li=new TextEncoder,In=e=>new Uint8Array(e),Bn=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),ui=(e,t)=>e.slice(0,t),fi=(e,{contents:t,length:r},n)=>{let o=$n()?pi(t,n):di(t,n);return new Uint8Array(o).set(e,r),o},di=(e,t)=>{if(t<=e.byteLength)return e;let r=new ArrayBuffer(_n(t));return new Uint8Array(r).set(new Uint8Array(e),0),r},pi=(e,t)=>{if(t<=e.maxByteLength)return e.resize(t),e;let r=new ArrayBuffer(t,{maxByteLength:_n(t)});return new Uint8Array(r).set(new Uint8Array(e),0),r},_n=e=>Nn**Math.ceil(Math.log(e)/Math.log(Nn)),Nn=2,mi=({contents:e,length:t})=>$n()?e:e.slice(0,t),$n=()=>"resize"in ArrayBuffer.prototype,hi={init:ai,convertChunk:{string:ci,buffer:In,arrayBuffer:In,dataView:Bn,typedArray:Bn,others:Oe},getSize:Pe,truncateChunk:ui,addChunk:fi,getFinalChunk:vt,finalize:mi};async function Re(e,t){if(!("Buffer"in globalThis))throw new Error("getStreamAsBuffer() is only supported in Node.js");try{return Fn(await Pt(e,t))}catch(r){throw r.bufferedData!==void 0&&(r.bufferedData=Fn(r.bufferedData)),r}}var Fn=e=>globalThis.Buffer.from(e);async function Rt(e,t){return Q(e,xi,t)}var yi=()=>({contents:"",textDecoder:new TextDecoder}),Ie=(e,{textDecoder:t})=>t.decode(e,{stream:!0}),gi=(e,{contents:t})=>t+e,bi=(e,t)=>e.slice(0,t),wi=({textDecoder:e})=>{let t=e.decode();return t===""?void 0:t},xi={init:yi,convertChunk:{string:Ct,buffer:Ie,arrayBuffer:Ie,dataView:Ie,typedArray:Ie,others:Oe},getSize:Pe,truncateChunk:bi,addChunk:gi,getFinalChunk:wi,finalize:Ot};var Gn=y(kn(),1),Ln=e=>{if(e!==void 0)throw new TypeError("The `input` and `inputFile` options cannot be both set.")},Ei=({input:e,inputFile:t})=>typeof t!="string"?e:(Ln(e),(0,Be.readFileSync)(t)),Dn=e=>{let t=Ei(e);if(Ce(t))throw new TypeError("The `input` option cannot be a stream in sync mode");return t},Ti=({input:e,inputFile:t})=>typeof t!="string"?e:(Ln(e),(0,Be.createReadStream)(t)),Un=(e,t)=>{let r=Ti(t);r!==void 0&&(Ce(r)?r.pipe(e.stdin):e.stdin.end(r))},zn=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=(0,Gn.default)();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},It=async(e,t)=>{if(!(!e||t===void 0)){await(0,Mn.setTimeout)(0),e.destroy();try{return await t}catch(r){return r.bufferedData}}},Bt=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(!(!e||!r))return t==="utf8"||t==="utf-8"?Rt(e,{maxBuffer:n}):t===null||t==="buffer"?Re(e,{maxBuffer:n}):Ai(e,n,t)},Ai=async(e,t,r)=>(await Re(e,{maxBuffer:t})).toString(r),Hn=async({stdout:e,stderr:t,all:r},{encoding:n,buffer:o,maxBuffer:s},a)=>{let l=Bt(e,{encoding:n,buffer:o,maxBuffer:s}),f=Bt(t,{encoding:n,buffer:o,maxBuffer:s}),u=Bt(r,{encoding:n,buffer:o,maxBuffer:s*2});try{return await Promise.all([a,l,f,u])}catch(p){return Promise.all([{error:p,signal:p.signal,timedOut:p.timedOut},It(e,l),It(t,f),It(r,u)])}};var Ci=(async()=>{})().constructor.prototype,vi=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(Ci,e)]),Nt=(e,t)=>{for(let[r,n]of vi){let o=typeof t=="function"?(...s)=>Reflect.apply(n.value,t(),s):n.value.bind(t);Reflect.defineProperty(e,r,{...n,value:o})}},Wn=e=>new Promise((t,r)=>{e.on("exit",(n,o)=>{t({exitCode:n,signal:o})}),e.on("error",n=>{r(n)}),e.stdin&&e.stdin.on("error",n=>{r(n)})});var Yn=require("node:buffer"),Kn=require("node:child_process"),Xn=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],Oi=/^[\w.-]+$/,Pi=e=>typeof e!="string"||Oi.test(e)?e:`"${e.replaceAll('"','\\"')}"`,_t=(e,t)=>Xn(e,t).join(" "),$t=(e,t)=>Xn(e,t).map(r=>Pi(r)).join(" "),Ri=/ +/g;var qn=e=>{let t=typeof e;if(t==="string")return e;if(t==="number")return String(e);if(t==="object"&&e!==null&&!(e instanceof Kn.ChildProcess)&&"stdout"in e){let r=typeof e.stdout;if(r==="string")return e.stdout;if(Yn.Buffer.isBuffer(e.stdout))return e.stdout.toString();throw new TypeError(`Unexpected "${r}" stdout in template expression`)}throw new TypeError(`Unexpected "${t}" in template expression`)},Vn=(e,t,r)=>r||e.length===0||t.length===0?[...e,...t]:[...e.slice(0,-1),`${e.at(-1)}${t[0]}`,...t.slice(1)],Ii=({templates:e,expressions:t,tokens:r,index:n,template:o})=>{let s=o??e.raw[n],a=s.split(Ri).filter(Boolean),l=Vn(r,a,s.startsWith(" "));if(n===t.length)return l;let f=t[n],u=Array.isArray(f)?f.map(p=>qn(p)):[qn(f)];return Vn(l,u,s.endsWith(" "))},Ft=(e,t)=>{let r=[];for(let[n,o]of e.entries())r=Ii({templates:e,expressions:t,tokens:r,index:n,template:o});return r};var Jn=require("node:util"),Zn=y(require("node:process"),1),Qn=(0,Jn.debuglog)("execa").enabled,Ne=(e,t)=>String(e).padStart(t,"0"),Bi=()=>{let e=new Date;return`${Ne(e.getHours(),2)}:${Ne(e.getMinutes(),2)}:${Ne(e.getSeconds(),2)}.${Ne(e.getMilliseconds(),3)}`},jt=(e,{verbose:t})=>{t&&Zn.default.stderr.write(`[${Bi()}] ${e}
`)};var Ni=1e3*1e3*100,_i=({env:e,extendEnv:t,preferLocal:r,localDir:n,execPath:o})=>{let s=t?{...ee.default.env,...e}:e;return r?on({env:s,cwd:n,execPath:o}):s},oo=(e,t,r={})=>{let n=no.default._parse(e,t,r);return e=n.command,t=n.args,r=n.options,r={maxBuffer:Ni,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||ee.default.cwd(),execPath:ee.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,verbose:Qn,...r},r.env=_i(r),r.stdio=yn(r),ee.default.platform==="win32"&&ro.default.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:n}},te=(e,t,r)=>typeof t!="string"&&!to.Buffer.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?pt(t):t;function P(e,t,r){let n=oo(e,t,r),o=_t(e,t),s=$t(e,t);jt(s,n.options),En(n.options);let a;try{a=_e.default.spawn(n.file,n.args,n.options)}catch(A){let T=new _e.default.ChildProcess,I=Promise.reject(Z({error:A,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return Nt(T,I),T}let l=Wn(a),f=Sn(a,n.options,l),u=Tn(a,n.options,f),p={isCanceled:!1};a.kill=wn.bind(null,a.kill.bind(a)),a.cancel=xn.bind(null,a,p);let S=an(async()=>{let[{error:A,exitCode:T,signal:I,timedOut:_},L,D,O]=await Hn(a,n.options,u),ne=te(n.options,L),oe=te(n.options,D),v=te(n.options,O);if(A||T!==0||I!==null){let se=Z({error:A,exitCode:T,signal:I,stdout:ne,stderr:oe,all:v,command:o,escapedCommand:s,parsed:n,timedOut:_,isCanceled:p.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:a.killed});if(!n.options.reject)return se;throw se}return{command:o,escapedCommand:s,exitCode:0,stdout:ne,stderr:oe,all:v,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return Un(a,n.options),a.all=zn(a,n.options),vn(a),Nt(a,S),a}function R(e,t,r){let n=oo(e,t,r),o=_t(e,t),s=$t(e,t);jt(s,n.options);let a=Dn(n.options),l;try{l=_e.default.spawnSync(n.file,n.args,{...n.options,input:a})}catch(p){throw Z({error:p,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}let f=te(n.options,l.stdout,l.error),u=te(n.options,l.stderr,l.error);if(l.error||l.status!==0||l.signal!==null){let p=Z({stdout:f,stderr:u,error:l.error,signal:l.signal,exitCode:l.status,command:o,escapedCommand:s,parsed:n,timedOut:l.error&&l.error.code==="ETIMEDOUT",isCanceled:!1,killed:l.signal!==null});if(!n.options.reject)return p;throw p}return{command:o,escapedCommand:s,exitCode:0,stdout:f,stderr:u,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}var $i=({input:e,inputFile:t,stdio:r})=>e===void 0&&t===void 0&&r===void 0?{stdin:"inherit"}:{},eo=(e={})=>({preferLocal:!0,...$i(e),...e});function so(e){function t(r,...n){if(!Array.isArray(r))return so({...e,...r});let[o,...s]=Ft(r,n);return P(o,s,eo(e))}return t.sync=(r,...n)=>{if(!Array.isArray(r))throw new TypeError("Please use $(options).sync`command` instead of $.sync(options)`command`.");let[o,...s]=Ft(r,n);return R(o,s,eo(e))},t}var Xc=so();var $e=e=>{throw e.code==="ENOENT"?new Error("Couldn't find the termux-api scripts. You can install them with: apt install termux-api"):e},Fi={async copy(e){try{await P("termux-clipboard-set",e)}catch(t){$e(t)}},async paste(e){try{let{stdout:t}=await P("termux-clipboard-get",e);return t}catch(t){$e(t)}},copySync(e){try{R("termux-clipboard-set",e)}catch(t){$e(t)}},pasteSync(e){try{return R("termux-clipboard-get",e).stdout}catch(t){$e(t)}}},io=Fi;var kt=y(require("node:path"),1),fo=require("node:url");var Mi={},ji=kt.default.dirname((0,fo.fileURLToPath)(Mi.url)),po="xsel",mo=kt.default.join(ji,"../fallbacks/linux/xsel"),ao=["--clipboard","--input"],co=["--clipboard","--output"],ho=(e,t)=>{let r;return e.code==="ENOENT"?r=new Error("Couldn't find the `xsel` binary and fallback didn't work. On Debian/Ubuntu you can install xsel with: sudo apt install xsel"):(r=new Error("Both xsel and fallback failed"),r.xselError=e),r.fallbackError=t,r},lo=async(e,t)=>{try{let{stdout:r}=await P(po,e,t);return r}catch(r){try{let{stdout:n}=await P(mo,e,t);return n}catch(n){throw ho(r,n)}}},uo=(e,t)=>{try{return R(po,e,t).stdout}catch(r){try{return R(mo,e,t).stdout}catch(n){throw ho(r,n)}}},ki={async copy(e){await lo(ao,e)},copySync(e){uo(ao,e)},paste:e=>lo(co,e),pasteSync:e=>uo(co,e)},yo=ki;var Fe={LC_CTYPE:"UTF-8"},Gi={copy:async e=>P("pbcopy",{...e,env:Fe}),async paste(e){let{stdout:t}=await P("pbpaste",{...e,env:Fe});return t},copySync:e=>R("pbcopy",{...e,env:Fe}),pasteSync:e=>R("pbpaste",{...e,env:Fe}).stdout},go=Gi;var Mt=y(require("node:path"),1),Eo=require("node:url");var bo=require("node:util"),wo=y(require("node:process"),1),je=y(require("node:child_process"),1),ol=(0,bo.promisify)(je.default.execFile);function xo(){let{arch:e,platform:t,env:r}=wo.default;return t==="darwin"&&e==="x64"?je.default.execFileSync("sysctl",["-inq","sysctl.proc_translated"],{encoding:"utf8"}).trim()==="1"?"arm64":"x64":e==="arm64"||e==="x64"?e:t==="win32"&&Object.hasOwn(r,"PROCESSOR_ARCHITEW6432")||t==="linux"&&je.default.execFileSync("getconf",["LONG_BIT"],{encoding:"utf8"}).trim()==="64"?"x64":e}var Li=new Set(["arm64","x64","ppc64","riscv64"]);function So(){return Li.has(xo())}var Hi={},Di=Mt.default.dirname((0,Eo.fileURLToPath)(Hi.url)),Ui=So()?"x86_64":"i686",ke=Mt.default.join(Di,`../fallbacks/windows/clipboard_${Ui}.exe`),zi={copy:async e=>P(ke,["--copy"],e),async paste(e){let{stdout:t}=await P(ke,["--paste"],e);return t},copySync:e=>R(ke,["--copy"],e),pasteSync:e=>R(ke,["--paste"],e).stdout},Gt=zi;var Me=(()=>{switch(Lt.default.platform){case"darwin":return go;case"win32":return Gt;case"android":{if(Lt.default.env.PREFIX!=="/data/data/com.termux/files/usr")throw new Error("You need to install Termux for this module to work on Android: https://termux.com");return io}default:return hr?Gt:yo}})(),re={};re.write=async e=>{if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);await Me.copy({input:e})};re.read=async()=>Me.paste({stripFinalNewline:!1});re.writeSync=e=>{if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);Me.copySync({input:e})};re.readSync=()=>Me.pasteSync({stripFinalNewline:!1});var To=re;var Ge=class{constructor(){this.divider="\u{1F680} "+"=".repeat(30)+" \u{1F680}"}async displayResults(t,r){if(t.length===0){this.displayNoStagedChanges();return}console.log(k(`
Commit messages for individual files:`)),t.forEach((n,o)=>{console.log(qe(`
File ${o+1}:`)),console.log(ue(n))}),console.log(`
`+k(this.divider)),console.log(k("Summary Commit Message:")),console.log(ue(r)),console.log(k(this.divider)+`
`);try{await To.write(r),console.log(k("Summary message copied to clipboard!"))}catch(n){this.logError("Failed to copy summary message to clipboard:",n)}}displayNoChanges(){console.log(fe("No significant changes detected across all files."))}displayNoStagedChanges(){console.log(fe("No files staged for commit. Use `git add` to stage changes."))}logProcessedFile(t){console.log(`Processing file: ${qe(t)}`)}logCommitMessage(t){console.log(`
Commit message:
${ue(t)}
`)}logSuccess(t){console.log(k(t))}logError(t,r){console.error(nr(t),r)}logWarning(t){console.warn(fe(t))}};async function Wi(){try{let{modelName:e,maxDiffSize:t,maxFiles:r}=rr(process.argv.slice(2)),n=new de(t,r),o=new ye(e),s=new ge(o),a=new Ge,l=await n.generateDiffs();if(l.length===0){a.displayNoStagedChanges();return}let f=await s.generateMessages(l);if(f.length>0){let u=await s.generateSummaryMessage(f);a.displayResults(f,u)}else a.displayNoChanges()}catch(e){console.error("Error:",e.message),process.exit(1)}}Wi();
